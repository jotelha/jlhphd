{% extends "fw_base.yaml" %}
{% block body %}
name: "{{ machine|default("NEMO",true) }}, {{ title }}, interface file retrieval and preprocessing"
spec:
  _category: {{ worker|default("nemo_noqueue",true) }}
  _files_out:
    interface_file: default.lammps

  _tasks:

  - _fw_name: GetFilesByQueryTask

    query:
      metadata->mode: "PRODUCTION"
      metadata->type: "interface"
      metadata->step: "equilibration_dpd"

      metadata->sb_name:          {{ sb_name }}
      metadata->solvent:          {{ solvent }}
      metadata->surfactant:       {{ surfactant }}
      metadata->sf_nmolecules:    {{ sf_nmolecules }}
      metadata->sf_preassembly:   {{ sf_preassembly }}

    fizzle_degenerate_file_name: False
    sort_key:                    metadata.workflow_creation_date
    sort_direction:              1 #ascending, i.e. oldest files first, newest written last

  metadata:
    state: interface datafile retrieval
    {{ render_metadata()|indent(4)}}
{% endblock %}
