{% extends "fw_base.yaml" %}
{% block body %}
name: {{ machine|default("NEMO",true) }}, {{ title }}, EAM substrate only, LAMMPS minimization, relaxed box
spec:
  _category: {{ worker|default("nemo_queue_offline",true) }}
  _queueadapter:
    {{ render_queueadapter()|safe|indent(4) }}
  _files_in:
    data_file:          datafile.lammps
    input_header:       lmp_header.input
    input_minimization: lmp_minimization.input
    coeff_file:         coeff.input
  _files_out:
    data_file: default.lammps
    log_file:  log.lammps
  _tasks:
  - _fw_name: CmdTask
    cmd: lmp
    opt:
    - -in lmp_minimization.input
    - -v coeffInfile          coeff.input
    - -v compute_interactions 0
    - -v dataFile             datafile.lammps
    - -v freeze_substrate     0
    - -v has_indenter         0
    - -v has_vacuum           0
    - -v minimization_ftol    {{ minimization_ftol|default('1.0e-5',true) }}
    - -v minimization_maxiter {{ minimization_maxiter|default(10000,true)|int }}
    - -v minimization_maxeval {{ minimization_maxeval|default(100000,true)|int }}
    - -v mpiio                0
    - -v pbc2d                0
    - -v pressureP            {{ pressure|default(1.0,true)|float }}
    - -v relax_box            1
    - -v rigid_h_bonds        0
    - -v robust_minimization  0
    - -v shrink_wrap_once     0
    - -v store_forces         0
    - -v surfactant_name      {{ surfactant|default("SDS") }}
    - -v use_eam              1
    - -v use_ewald            0
    - -v write_coeff_to_datafile 0
    stderr_file: std.err
    stdout_file: std.out
    store_stdout:  true
    store_stderr:  true
    use_shell:     true
    fizzle_bad_rc: true
  _trackers:
  - filename: log.lammps
    nlines: 25

  metadata:
    state: minimization, relaxed box
    {{ render_metadata()|indent(4) }}
{% endblock %}
