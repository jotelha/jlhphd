{% set identifier = "interface/%s/%d/%s/%s/%dx%dx%d/%s"|format(surfactant,sf_nmolecules,substrate,sb_crystal_plane,sb_multiples[0],sb_multiples[1],sb_multiples[2],sf_preassembly) %}
{% set title = "%d %s on %s %s %dx%dx%d substrate, %s"|format(surfactant,sf_nmolecules,substrate,sb_crystal_plane,sb_multiples[0],sb_multiples[1],sb_multiples[2],sf_preassembly) %}

name: "{{ machine|default("NEMO",true) }}, {{title}}, file retrieval and preprocessing"
spec:
  _category: {{ worker|default("nemo_noqueue",true) }}
  _files_out:
    initial_configuration_file: datafile.lammps
    input_header:               lmp_header.input
    input_minimization:         lmp_minimization.input
    input_equilibration_nvt:    lmp_equilibration_nvt.input
    input_equilibration_npt:    lmp_equilibration_npt.input
    coeff_file:                 coeff_hybrid.input
  _tasks:

  - _fw_name: GetFilesTask
    identifiers:
    - lmp_header.input
    - lmp_minimization.input
    - lmp_equilibration_nvt.input
    - lmp_equilibration_npt.input

  - _fw_name: GetFilesTask
    identifiers:
    - {{ substrate_identifier|default("substrate/AU/111/52x30x8.lammps") }}
    new_file_names:
    - datafile.lammps

  - _fw_name: GetFilesTask
    identifiers:
    - {{ coeff_identifier }}
    new_file_names:
    - coeff_hybrid.input