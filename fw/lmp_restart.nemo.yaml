name: "NEMO LAMMPS Run Restart"
spec:
    _category: "nemo_queue"
    _queueadapter:
      nodes: 8
      ppn: 20
      queue: ''
      walltime: 96:00:00
    _files_in:
      restart_file:    default.mpiio.restart
    _files_out:
      data_file:       default.lammps
      traj_file:       default.nc
      log_file:        lammps.log
    _tasks:
    - _fw_name: GetFilesTask
      identifiers:
      - lmp_header.input
      - lmp_production.input
      - lmp_production_mixed.input
    - _fw_name: ScriptTask
      script:
      - module purge; 
        module load lammps/16Mar18-gnu-7.3-openmpi-3.1-colvars-09Feb19;
        mpirun ${MPIRUN_OPTIONS} lmp -in lmp_production.input
        -v has_indenter 1 -v pbd2d 0 -v constant_indenter_velocity -0.0000100 
        -v reinitialize_velocities 0 -v productionSteps 3750000 -v use_colvars 0
        -v mpiio 1 -v thermo_frequency 1000 -v thermo_average_frequency 1000 
        -v netcdf_frequency 10000 -v compute_interactions 1 -v store_forces 1 
        -v surfactant_name SDS -v is_restart 1 -v restartFile default.mpiio.restart
      stderr_file: lmp_production.err
      stdout_file: lmp_production.out
      fizzle_bad_rc: true
      use_shell: true

metadata:
  - system_name:      646_SDS_on_AU_111_51x30x2_hemicylinders_with_counterion_50Ang_stepped
    surfactant:       SDS
    sf_nmolecules:    646
    sf_preassembly:   hemicylinders
    counterion:       NA
    ci_preassembly:   at polar heads
    substrate:        AU
    sb_name:          AU_111_51x30x2
    sb_crystal_plane: 111
    sb_multiples:
    - 51
    - 30
    - 2
    solvent:          H2O
    sv_density:       997 # kg m^-3
    sv_preassembly:   random
    indenter:         AU
    indenter_pdb:     50Ang_stepped
    temperature:      298 # K
    pressure:         1 # atm
