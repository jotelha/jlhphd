{% extends "fw_base.yaml" %}
{% block body %}
name: {{ title }}, production, {{ comment }}
spec:
  _category: {{ worker|default("juwels_queue",true) }}
  _queueadapter:
    {{ render_queueadapter()|safe|indent(4) }}
  _files_in:
    data_file:                  datafile.lammps
    input_file:                 production.input
  _files_out:
    data_file: final.lammps
    log_file:  log.lammps
  _tasks:
  - _fw_name: CmdTask
    cmd: lmp
    opt:
    - -in production.input
    - -v productionSteps  {{ production_steps|default(10000,true)|int }}
    - -v pressureP        {{ pressure|default(0.0,true)|float }}
    - -v temperatureT     {{ temperature|default(298.0)|float }}
    stderr_file:    std.err
    stdout_file:    std.out
    store_stdout:   true
    store_stderr:   true
    use_shell:      true
    fizzle_bad_rc:  true
  _trackers:
  - filename: log.lammps
    nlines: 25
  metadata:
    step:  production, {{ comment }}
    {{ render_metadata()|indent(4)}}
{% endblock %}
